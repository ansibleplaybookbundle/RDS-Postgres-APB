FROM ansibleplaybookbundle/apb-base
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.spec"=\
"IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjCiMgU2hhcmVkIFBhcmFtZXRlcnMKIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
Cl9wOiAmX3AKICAtIG5hbWU6IGF3c19hY2Nlc3Nfa2V5CiAgICBkZXNjcmlwdGlvbjogYXdzIGFj\
Y2VzcyBrZXkgdG8gYXV0aGVudGljYXRlIHRvIGF3cyB3aXRoCiAgICB0eXBlOiBzdHJpbmcKICAt\
IG5hbWU6IGF3c19zZWNyZXRfa2V5CiAgICBkZXNjcmlwdGlvbjogYXdzIHNlY3JldCBrZXkgdG8g\
YXV0aGVudGljYXRlIHRvIGF3cyB3aXRoCiAgICB0eXBlOiBzdHJpbmcKICAtIG5hbWU6IGJhY2t1\
cF9yZXRlbnRpb24KICAgIGRlc2NyaXB0aW9uOiBiYWNrdXAgcmV0ZW50aW9uIHBlcmlvZAogICAg\
dHlwZTogaW50CiAgICBkZWZhdWx0OiAwCiAgLSBuYW1lOiBkYl9lbmdpbmUKICAgIGRlc2NyaXB0\
aW9uOiBkYXRhYmFzZSBlbmdpbmUKICAgIHR5cGU6IHN0cmluZwogICAgZGVmYXVsdDogcG9zdGdy\
ZXMKICAtIG5hbWU6IGRiX25hbWUKICAgIGRlc2NyaXB0aW9uOiBuYW1lIG9mIHRoZSBkYXRhYmFz\
ZSB0byBjcmVhdGUKICAgIHR5cGU6IHN0cmluZwogICAgZGVmYXVsdDogdGVzdGRiCiAgLSBuYW1l\
OiBkYl9wYXNzd29yZAogICAgZGVzY3JpcHRpb246IG1hc3RlciBwYXNzd29yZAogICAgdHlwZTog\
c3RyaW5nCiAgICBkZWZhdWx0OiBkYnBhc3N3ZAogIC0gbmFtZTogZGJfc2l6ZQogICAgZGVzY3Jp\
cHRpb246IHNpemUgb2YgdGhlIGRiIGluIGdiCiAgICB0eXBlOiBpbnQKICAgIGRlZmF1bHQ6IDEw\
CiAgLSBuYW1lOiBkYl91c2VybmFtZQogICAgZGVzY3JpcHRpb246IG1hc3RlciBkYiB1c2VybmFt\
ZQogICAgdHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiBkYnVzZXIKICAtIG5hbWU6IGVuZ2luZV92\
ZXJzaW9uCiAgICBkZXNjcmlwdGlvbjogZGIgZW5naW5lIHZlcnNpb24KICAgIHR5cGU6IHN0cmlu\
ZwogICAgZGVmYXVsdDogOS42LjEKICAtIG5hbWU6IGluc3RhbmNlX3R5cGUKICAgIGRlc2NyaXB0\
aW9uOiBhd3MgaW5zdGFuY2UgdHlwZQogICAgdHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiBkYi5t\
My5tZWRpdW0KICAtIG5hbWU6IHBvcnQKICAgIGRlc2NyaXB0aW9uOiBwb3J0IHRoZSBkYXRhYmFz\
ZSB3aWxsIGxpc3RlbiBvbgogICAgdHlwZTogaW50CiAgICBkZWZhdWx0OiA1NDMyCiAgLSBuYW1l\
OiByZWdpb24KICAgIGRlc2NyaXB0aW9uOiBhd3MgcmVnaW9uCiAgICB0eXBlOiBzdHJpbmcKICAt\
IG5hbWU6IHN1Ym5ldAogICAgZGVzY3JpcHRpb246IHZwYyBzdWJuZXQgdG8gZGVwbG95IGluc3Rh\
bmNlIG9uCiAgICB0eXBlOiBzdHJpbmcKICAtIG5hbWU6IHZwY19zZWN1cml0eV9ncm91cHMKICAg\
IGRlc2NyaXB0aW9uOiB2cGMgc2VjdXJpdHkgZ3JvdXBzIHRvIGFzc2lnbiB0byB0aGUgaW5zdGFu\
Y2UKICAgIHR5cGU6IHN0cmluZwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnZlcnNpb246IDEuMApu\
YW1lOiByZHMtcG9zdGdyZXMtYXBiCmltYWdlOiBhbnNpYmxlcGxheWJvb2tidW5kbGUvcmRzLXBv\
c3RncmVzLWFwYgpkZXNjcmlwdGlvbjogTWFuYWdlZCByZWxhdGlvbmFsIGRhdGFiYXNlIHNlcnZp\
Y2Ugd2l0aCBhIGNob2ljZSBvZiBzaXggcG9wdWxhciBkYXRhYmFzZSBlbmdpbmVzLiAgU2V0IHVw\
LCBvcGVyYXRlLCBhbmQgc2NhbGUgYSByZWxhdGlvbmFsIGRhdGFiYXNlIGluIHRoZSBjbG91ZCB3\
aXRoIGp1c3QgYSBmZXcgY2xpY2tzLgp0YWdzOgogIC0gYW1hem9uCiAgLSBkYXRhYmFzZQpiaW5k\
YWJsZTogdHJ1ZQphc3luYzogb3B0aW9uYWwKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6ICJBbWF6\
b24gUkRTIC0gUG9zdGdyZVNRTCAoQVBCKSIKICBsb25nRGVzY3JpcHRpb246ICJBbWF6b24gUmVs\
YXRpb25hbCBEYXRhYmFzZSBTZXJ2aWNlIChBbWF6b24gUkRTKSBtYWtlcyBpdCBlYXN5IHRvIHNl\
dCB1cCwgb3BlcmF0ZSwgYW5kIHNjYWxlIGEgcmVsYXRpb25hbCBkYXRhYmFzZSBpbiB0aGUgY2xv\
dWQuIEl0IHByb3ZpZGVzIGNvc3QtZWZmaWNpZW50IGFuZCByZXNpemFibGUgY2FwYWNpdHkgd2hp\
bGUgbWFuYWdpbmcgdGltZS1jb25zdW1pbmcgZGF0YWJhc2UgYWRtaW5pc3RyYXRpb24gdGFza3Ms\
IGZyZWVpbmcgeW91IHVwIHRvIGZvY3VzIG9uIHlvdXIgYXBwbGljYXRpb25zIGFuZCBidXNpbmVz\
cy4gQW1hem9uIFJEUyBwcm92aWRlcyB5b3Ugc2l4IGZhbWlsaWFyIGRhdGFiYXNlIGVuZ2luZXMg\
dG8gY2hvb3NlIGZyb20sIGluY2x1ZGluZyBBbWF6b24gQXVyb3JhLCBQb3N0Z3JlU1FMLCBNeVNR\
TCwgTWFyaWFEQiwgT3JhY2xlLCBhbmQgTWljcm9zb2Z0IFNRTCBTZXJ2ZXIuIgogIGltYWdlVXJs\
OiAiaHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tL2Z1c29yLzIwMTdkZW1vL0RhdGFiYXNlX0FtYXpv\
blJEU19Qb3N0Z3JlU1FMaW5zdGFuY2UucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRwczov\
L2F3cy5hbWF6b24uY29tL3Jkcy8iCiAgZGVwZW5kZW5jaWVzOiBbXQogIHByb3ZpZGVyRGlzcGxh\
eU5hbWU6ICJBbWF6b24iCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246\
IFJEUyBQb3N0Z3Jlc3FsIGRlcGxveW1lbnQgdG8gQVdTCiAgICBmcmVlOiB0cnVlCiAgICBtZXRh\
ZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERlZmF1bHQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBU\
aGlzIHBsYW4gcHJvdmlkZXMgYW4gUkRTIFBvc3RncmVzcWwgZGVwbG95bWVudCB0byBBbWF6b24g\
V2ViIFN0b3JhZ2UKICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6ICpfcAo="
COPY roles /opt/ansible/roles
COPY playbooks /opt/apb/actions
RUN chmod -R g=u /opt/{ansible,apb}

RUN yum -y install python-boto postgresql && yum clean all

USER apb
